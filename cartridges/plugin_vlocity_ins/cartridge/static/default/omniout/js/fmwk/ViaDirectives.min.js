!function(){!function(){"use strict";var scripts=document.getElementsByTagName("script"),scriptName=scripts[scripts.length-1].src,parts=scriptName.split("/"),partsLength=parts.length-1,thisScript=parts[partsLength--];if(""===thisScript&&(thisScript=parts[partsLength--]),-1!=scriptName.indexOf("__"))for(;-1==thisScript.indexOf("__")&&partsLength>=0;)thisScript=parts[partsLength],partsLength--;var lowerCasePrefix=-1==thisScript.indexOf("__")?"":thisScript.substring(0,thisScript.indexOf("__")+2);if(""!==(lowerCasePrefix=""===lowerCasePrefix&&localStorage.getItem("nsPrefix")?localStorage.getItem("nsPrefix"):lowerCasePrefix)&&(lowerCasePrefix=/__$/.test(lowerCasePrefix)?lowerCasePrefix:lowerCasePrefix+"__"),0===lowerCasePrefix.length)return function(){return""!==(lowerCasePrefix=window.nsPrefix?window.nsPrefix:lowerCasePrefix)&&(lowerCasePrefix=/__$/.test(lowerCasePrefix)?lowerCasePrefix:lowerCasePrefix+"__"),lowerCasePrefix};var resolvedNs=null}();!function(){return function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}}()({1:[function(require,module,exports){angular.module("viaDirectives",[]),require("./modules/viaDirectives/directive/GroupedTable.js"),require("./modules/viaDirectives/directive/NumberInputNullValueFix.js"),require("./modules/viaDirectives/directive/PreventDeleteBack.js"),require("./modules/viaDirectives/directive/ViaAffix.js"),require("./modules/viaDirectives/directive/ViaMask.js"),require("./modules/viaDirectives/directive/ViaScreenHeight.js"),require("./modules/viaDirectives/directive/ViaFileReader.js"),require("./modules/viaDirectives/factory/InterTabMsgBus.js"),require("./modules/viaDirectives/filter/GroupAndExpanded.js"),require("./modules/viaDirectives/filter/HtmlEncodeDecode.js"),require("./modules/viaDirectives/templates/templates.js")},{"./modules/viaDirectives/directive/GroupedTable.js":2,"./modules/viaDirectives/directive/NumberInputNullValueFix.js":3,"./modules/viaDirectives/directive/PreventDeleteBack.js":4,"./modules/viaDirectives/directive/ViaAffix.js":5,"./modules/viaDirectives/directive/ViaFileReader.js":6,"./modules/viaDirectives/directive/ViaMask.js":7,"./modules/viaDirectives/directive/ViaScreenHeight.js":8,"./modules/viaDirectives/factory/InterTabMsgBus.js":9,"./modules/viaDirectives/filter/GroupAndExpanded.js":10,"./modules/viaDirectives/filter/HtmlEncodeDecode.js":11,"./modules/viaDirectives/templates/templates.js":12}],2:[function(require,module,exports){angular.module("viaDirectives").directive("groupedTable",function($modal,$q,$localizable,$rootScope){"use strict";return{restrict:"AEC",scope:{rowData:"=",name:"@",delete:"&onDelete",loading:"="},link:function(scope){function rowGroupID(row){return row.Name}function sortByVersion(a,b){return a.Version__c>b.Version__c?-1:a.Version__c<b.Version__c?1:0}scope.rows=[],scope.$watchCollection("rowData",function(newRowData){var groupedTemplateMap,existingExpandedModules={};scope.rows&&scope.rows.forEach(function(row){var id=rowGroupID(row);existingExpandedModules[id]=row.expand||existingExpandedModules[id]}),groupedTemplateMap=(newRowData||[]).map(function(row){return angular.copy(row)}).sort(function(a,b){var nameSortValue=function(a,b){return a.Name.toLowerCase()>b.Name.toLowerCase()?1:a.Name.toLowerCase()<b.Name.toLowerCase()?-1:0}(a,b);return 0!==nameSortValue?nameSortValue:sortByVersion(a,b)}).reduce(function(rowMap,row){var id=rowGroupID(row);return rowMap[id]?rowMap[id].rows.push(row):rowMap[id]=angular.extend(row,{group:!0,expand:!1,rows:[]}),rowMap[id].expand=row.expand=existingExpandedModules[id],rowMap[id].IsActive__c=row.IsActive__c|rowMap[id].IsActive__c,rowMap},{}),scope.rows=Object.keys(groupedTemplateMap).reduce(function(array,key){return groupedTemplateMap[key].rows.sort(sortByVersion),array.concat([groupedTemplateMap[key]]).concat(groupedTemplateMap[key].rows)},[]),scope.loading=!1}),scope.expand=function(groupedTemplate,shouldExpand){groupedTemplate.rows.forEach(function(row){row.expand=shouldExpand}),groupedTemplate.expand=shouldExpand},scope.deleteTemplate=function(row){var modalScope=scope.$new();modalScope.ok=function(){},$modal({title:$localizable("TemplateHomeConfirmDelete","Confirm deletion"),rowUrl:"ConfirmationModal.tpl.html",content:$localizable("TemplateHomeConfirmDeleteContent",'Are you sure you want to delete "{1}" (version {2})? <br/><br/> <i>Cards in this row will remain available for use in other rows.</i>',row.Name,row[$rootScope.nsPrefix+"Version__c"]),scope:modalScope,html:!0,show:!0})}}}})},{}],3:[function(require,module,exports){angular.module("viaDirectives").directive("input",function(){"use strict";return{restrict:"E",require:"?ngModel",link:function(scope,elem,attrs,ctrl){null!=attrs.type&&"number"===attrs.type.toLowerCase()&&ctrl.$formatters.push(function(value){return isNaN(value)?null:parseFloat(value)})}}})},{}],4:[function(require,module,exports){angular.module("viaDirectives").directive("preventDeleteBack",function(){"use strict";return function(){var rx=/INPUT|SELECT|TEXTAREA/i;angular.element(document).bind("keydown keypress",function(e){8===e.which&&(!rx.test(e.target.tagName)||e.target.disabled||e.target.readOnly)&&e.preventDefault()})}})},{}],5:[function(require,module,exports){angular.module("viaDirectives").directive("viaAffix",function(){"use strict";return function(scope,element){var stickyTop=$(element).offset().top;$(window).scroll(function(){var windowTop=$(window).scrollTop();stickyTop<windowTop?($(element).parent().height($(window).height()),$(element).css({position:"fixed",top:0,width:"100%"}),$(element).addClass("viaAffix")):($(element).removeClass("viaAffix"),$(element).css("position","static"))})}})},{}],6:[function(require,module,exports){angular.module("viaDirectives").directive("viaFilereader",function($q){"use strict";console.log("calling appFilereader");var slice=Array.prototype.slice;return{restrict:"A",require:"?ngModel",link:function(scope,element,attrs,ngModel){ngModel?(ngModel.$render=function(){},element.bind("change",function(e){var element=e.target;console.log("file input changed"),element.value&&(element.disabled=!0,$q.all(slice.call(element.files,0).map(function(file){var deferred=$q.defer(),reader=new FileReader;return reader.onload=function(e){deferred.resolve(e.target.result)},reader.onerror=function(e){deferred.reject(e)},reader.readAsText(file),deferred.promise})).then(function(values){element.multiple?ngModel.$setViewValue(JSON.parse(values)):ngModel.$setViewValue(values.length?JSON.parse(values[0]):null),element.value=null,element.disabled=!1}))})):console.log("no ngModel")}}})},{}],7:[function(require,module,exports){window.format=require("../../../util/javascript-number-formatter.js");var format=window.format;Number.MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER||9007199254740991,Number.MIN_SAFE_INTEGER=Number.MIN_SAFE_INTEGER||-9007199254740991,angular.module("viaDirectives").directive("viaMask",function($parse){"use strict";var decimalSeperator=".";try{var sep=parseFloat(1.5).toLocaleString().substring(1,2);"."!==sep&&","!==sep||(decimalSeperator=sep)}catch(e){}var decimalKeyCode="."===decimalSeperator?46:44,replacementRegex=new RegExp("[^-\\"+decimalSeperator+"\\d]","g");function parseFloatIfNum(value){return isNaN(value)?value:parseFloat(value)}function cleanNumberValue(value){return isNaN(value)?"string"==typeof value?value.replace(replacementRegex,"").replace(decimalSeperator,"."):NaN:value}return{restrict:"A",require:"ngModel",link:function(scope,element,attrs,ctrl){function getMask(){return $parse(attrs.viaMask)(scope)}function parser(value,isFromProgrammaticCall){var mask=getMask(),modelValue=ctrl.$modelValue;if(!isFromBlur||ctrl.$isEmpty(value)||null==mask||!ctrl.$valid)return parseFloatIfNum(value);var convertedValue=cleanNumberValue(modelValue);if(isNaN(convertedValue))return modelValue;var formatedValue=""+format(mask,parseFloat(convertedValue));return ctrl.$viewValue!==formatedValue&&(ctrl.$setViewValue(formatedValue),ctrl.$render()),isFromProgrammaticCall?parseFloat(convertedValue):parseFloatIfNum(modelValue)}ctrl.$validators.minInt=function(value){return ctrl.$isEmpty(value)||value>=Number.MIN_SAFE_INTEGER},ctrl.$validators.maxInt=function(value){return ctrl.$isEmpty(value)||value<=Number.MAX_SAFE_INTEGER},$(element).on("keypress",function(evt){var _ref,_ref1;(8!==(_ref=evt.keyCode)&&9!==_ref&&35!==_ref&&36!==_ref&&37!==_ref&&39!==_ref&&46!==_ref&&(_ref1=evt.which)!==decimalKeyCode&&45!==_ref1&&48!==_ref1&&49!==_ref1&&50!==_ref1&&51!==_ref1&&52!==_ref1&&53!==_ref1&&54!==_ref1&&55!==_ref1&&56!==_ref1&&57!==_ref1||(_ref===decimalKeyCode||_ref1===decimalKeyCode)&&evt.target.value.indexOf(decimalSeperator)>-1||(45===_ref||45===_ref1)&&(0!==evt.target.selectionStart||evt.target.value.indexOf("-")>-1)||0===evt.target.selectionStart&&evt.target.value.indexOf("-")>-1&&0===evt.target.selectionEnd)&&evt.preventDefault()});var isFromBlur=!1;$(element).on("focus",function(){formatOnFirstTime=!1;try{if(ctrl.$valid){var cusorPos=this.selectionStart,convertedValue=cleanNumberValue(ctrl.$modelValue);if(isNaN(convertedValue))return;ctrl.$setViewValue(convertedValue),ctrl.$render(),this.selectionStart=cusorPos}}catch(e){}}),$(element).on("blur",function(){isFromBlur=!0;try{scope.$apply(function(){parser(ctrl.$viewValue,!0)})}catch(e){}isFromBlur=!1});var formatOnFirstTime=!0;scope.$watch(function(){return ctrl.$modelValue},function(newValue){if(formatOnFirstTime&&null!=newValue){isFromBlur=!0;try{parser(newValue,!0)}catch(e){}isFromBlur=formatOnFirstTime=!1}}),ctrl.$formatters.push(function(value){var mask=getMask();if(ctrl.$isEmpty(value)||null==mask||!ctrl.$valid)return value;var convertedValue=cleanNumberValue(value);return isNaN(convertedValue)?value:""+format(mask,convertedValue)}),ctrl.$parsers.push(parser),attrs.viaMask&&scope.$watch(attrs.viaMask,function(){parser(ctrl.$viewValue)})}}})},{"../../../util/javascript-number-formatter.js":13}],8:[function(require,module,exports){angular.module("viaDirectives").directive("viaScreenHeight",function($window){"use strict";return function(scope,element){var el=element[0];el.style.height=$window.document.documentElement.clientHeight+"px",scope.$watch(function(){return $window.document.documentElement.clientHeight},function(){el.style.height=$window.document.documentElement.clientHeight+"px"});var previousHeight=el.style.height;setInterval(function(){var docHeight=$window.document.documentElement.clientHeight;docHeight!==previousHeight&&(el.style.height=docHeight+"px",previousHeight=docHeight)},50)}})},{}],9:[function(require,module,exports){angular.module("viaDirectives").factory("interTabMsgBus",function(){"use strict";var listeners={},tabKey=Date.now().toString(),keysAdded=[];return $(window).on("storage",function(e){if((e=e.originalEvent).key){var keyParts=e.key.split(".");keyParts[0]===tabKey&&listeners[keyParts[1]]&&listeners[keyParts[1]].forEach(function(callbackConfig){callbackConfig.fn.apply(callbackConfig.scope,[e.newValue,e.oldValue])})}}),$(window).on("beforeunload",function(){keysAdded.forEach(function(key){localStorage.removeItem(tabKey+"."+key)})}),{tabKey:function(){return tabKey},on:function(key,listener,scope){listeners[key]||(listeners[key]=[]),listeners[key].push({fn:listener,scope:scope})},set:function(key,value){keysAdded.push(key),localStorage.setItem(tabKey+"."+key,value)},get:function(key){return localStorage.getItem(tabKey+"."+key)},delete:function(key){localStorage.removeItem(tabKey+"."+key)}}})},{}],10:[function(require,module,exports){angular.module("viaDirectives").filter("groupAndExpanded",function(){"use strict";return function(objects){var output=[];return objects&&(output=objects.filter(function(object){return object.group||object.expand})),output}})},{}],11:[function(require,module,exports){var escape=document.createElement("textarea");function escapeHTML(html){"use strict";return angular.isString(html)?(escape.innerHTML=html,escape.innerHTML):html}function unescapeHTML(html){"use strict";return angular.isString(html)?(escape.innerHTML=html,escape.value):html}angular.module("viaDirectives").filter("htmlEscape",function(){"use strict";return escapeHTML}).filter("htmlUnescape",function(){"use strict";return unescapeHTML})},{}],12:[function(require,module,exports){angular.module("viaDirectives").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("GroupedTable.tpl.html",'<div class="panel panel-sf">\n  <div class="panel-heading">\n    {{ title }}\n    <a href="{{newUrl}}" class="btn-primary btn pull-right">{{ ::\'VlocNew\' | localize:\'New\' }}</a>\n  </div>\n  <table class="table table-grouped" ng-table="tableParams" template-pagination="removePagerRow.html" show-group="false">\n    <colgroup>\n      <col width="5%" />\n      <col width="35%" />\n      <col width="20%" />\n      <col width="20%" />\n      <col width="20%" />\n    </colgroup>\n    <tr class="ng-table-group" ng-repeat-start="group in $groups">\n      <td>\n        <i class="icon" ng-click="group.$hideRows = !group.$hideRows"\n           ng-class="{\'icon-v-right-arrow\': group.$hideRows, \'icon-v-down-arrow\': !group.$hideRows}"></i>\n      </td>\n      <td colspan="{{$groups.visibleColumnCount - 1}}">{{ group.value }}</td>\n    </tr>\n    <tr ng-hide="group.$hideRows" ng-repeat="row in group.data" ng-repeat-end=" ">\n      <td data-title="\'\'">&nbsp;</td>\n      <td data-title="::\'VlocName\' | localize:\'Name\'">\n        <div>\n          <a href="{!newUrl}?id={{row.Id}}">{{ ::\'VlocEdit\' | localize:\'Edit\' }}</a>\n          <span ng-if="!row[$root.nsPrefix+\'Active__c\']"> | </span>\n          <a href="{!newUrl}?id={{row.Id}}">{{ ::\'VlocExport\' | localize:\'Export\' }}</a>\n          <span ng-if="!row[$root.nsPrefix+\'Active__c\']"> | </span>\n          <a ng-click="deleteLayout(row)" ng-if="!row[$root.nsPrefix+\'Active__c\']">{{ ::\'VlocDelete\' | localize:\'Delete\' }}</a>\n        </div>\n      </td>\n'+"      <td data-title=\"::'VlocType' | localize:'Type'\">{{row[$root.nsPrefix+'Type__c']}}</td>\n      <td data-title=\"::'TemplateParent' | localize:'Parent Template'\">{{row[$root.nsPrefix+'Version__c'] | number:1}}</td>\n      <td data-title=\"::'VlocVersion' | localize:'Version'\">{{row[$root.nsPrefix+'Version__c'] | number:1}}</td>\n      <td data-title=\"::'VlocActive' | localize:'Active'\"><i class=\"icon icon-v-check\" ng-if=\"row[$root.nsPrefix+'Active__c']\"></i> </td>\n    </tr>\n  </table>\n  <div class=\"mask\" ng-if=\"loading\">\n    <div class=\"center-block spinner\"></div>\n  </div>\n</div>"),$templateCache.put("DeleteModal.tpl.html",'<div class="modal vlocity" tabindex="-1" role="dialog" aria-hidden="true">\n  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header" ng-show="title">\n        <button type="button" class="close" aria-label="Close" ng-click="$hide()"><span aria-hidden="true">&times;</span></button>\n        <h4 class="modal-title" ng-bind="title"></h4>\n      </div>\n      <div class="modal-body" ng-bind="content"></div>\n      <div class="modal-footer">\n        <button type="button" class="btn btn-primary" ng-click="ok();$hide()">{{ ::\'LayoutConfirmOk\' | localize: \'Delete\' }}</button>\n        <button type="button" class="btn btn-default" ng-click="$hide()">{{ ::\'LayoutConfirmCancel\' | localize: \'Cancel\' }}</button>\n      </div>\n    </div>\n  </div>\n</div>')}])},{}],13:[function(require,module,exports){!function(root,factory){"use strict";"function"==typeof define&&define.amd?define([],factory):"object"==typeof module?module.exports=factory():root.format=factory()}(this,function(){"use strict";function toFixed(number,numDigits){return(null==numDigits||isNaN(numDigits))&&(numDigits=0),number=number.toString().split("e"),(+((number=(number=Math.round(+(number[0]+"e"+(number[1]?+number[1]+numDigits:numDigits)))).toString().split("e"))[0]+"e"+(number[1]?+number[1]-numDigits:-numDigits))).toFixed(numDigits)}return function(mask,value){if(!mask||isNaN(+value))return value;var isNegative,result,decimal,group,posLeadZero,posTrailZero,posSeparator,part,szSep,integer,len=mask.length,start=mask.search(/[0-9\-\+#]/),prefix=start>0?mask.substring(0,start):"",str=mask.split("").reverse().join(""),end=str.search(/[0-9\-\+#]/),offset=len-end,indx=offset+("."===mask.substring(offset,offset+1)?1:0),suffix=end>0?mask.substring(indx,len):"";if(isNegative=(value="-"===(mask=mask.substring(start,indx)).charAt(0)?-value:+value)<0?value=-value:0,decimal=(result=mask.match(/[^\d\-\+#]/g))&&result[result.length-1]||".",result&&1===result.length&&"."!==result[0]&&(decimal="."),group=result&&result[1]&&result[0]||",",value=+(value=toFixed(value,(mask=mask.split(decimal))[1]&&mask[1].length))+"",posTrailZero=mask[1]&&mask[1].length-1,(!(part=value.split("."))[1]||part[1]&&part[1].length<=posTrailZero)&&(value=toFixed(+value,posTrailZero+1)),szSep=mask[0].split(group),mask[0]=szSep.join(""),(posLeadZero=mask[0]&&mask[0].indexOf("0"))>-1)for(;part[0].length<mask[0].length-posLeadZero;)part[0]="0"+part[0];else 0==+part[0]&&(part[0]="");if((value=value.split("."))[0]=part[0],posSeparator=szSep[1]&&szSep[szSep.length-1].length){for(str="",offset=(integer=value[0]).length%posSeparator,len=integer.length,indx=0;indx<len;indx++)str+=integer.charAt(indx),!((indx-offset+1)%posSeparator)&&indx<len-posSeparator&&(str+=group);value[0]=str}return value[1]=mask[1]&&value[1]?decimal+value[1]:"","0"!==(result=value.join(""))&&""!==result||(isNegative=!1),prefix+(isNegative?"-":"")+result+suffix}})},{}]},{},[1])}();
//# sourceMappingURL=ViaDirectives.min.js.map